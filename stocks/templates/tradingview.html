<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stocks Form</title>
    
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <!-- DataTables CSS -->
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.4/css/jquery.dataTables.min.css">

    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <!-- DataTables JS -->
    <script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>

        
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            margin: 0;
            padding: 0;
            
        }
        
        .container {
            width: 96%;
            margin: 20px auto;
            padding: 30px;
            background-color: #fff;
            border-radius: 10px;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.1);
            margin: 20px 0;
        

        }
        h3 {
            margin-top: 0;
        }   
        .flashes {
            list-style-type: none;
            padding: 0;
            margin: 10px 0;
        }
        .flashes li {
            padding: 10px;
            border-radius: 4px;
            margin-bottom: 5px;
        }
        .flashes .error {
            background-color: #f8d7da;
            color: #721c24;
        }
        .flashes .success {
            background-color: #d4edda;
            color: #155724;
        }
        p {
            font-size: 16px;
            color: #555;
        }
               
        .form-container {
            width: 100%; 
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between; 
            flex-direction: column;
            gap: 10px;
        }
        .form-row {
            display: flex;
            align-items: center;
            gap: 20px;
        }
        .form-row > div {
            display: flex;
            align-items: center;
        }
        .form-row label {
            display: inline-block;
            width: auto; /* Let the label width adjust to the content */
            margin-right: 10px; 
        }
        .form-container input {
            flex: 1; /* Make inputs responsive to take up available space */
            margin-bottom: 10px; /* Spacing between form elements */
        }
        
        .submit-btn {
            margin-left: auto; /* Align the submit button to the right */
            margin-right: 0; /* Remove any extra margin after the submit button */
        }
        
        label[for="stock-select"] {
            white-space: nowrap; /* Force "Select Stock" to stay on one line */
        }
        .historical-data {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
        }
        .date-row {
            display: flex;
            align-items: center;
            gap: 20px;
        }
        .date-row label {
            margin-right: 10px;
        }
        button[type="submit"] {
            width: 140px;
            padding: 12px;
            background-color: #3498db; /* Blue color for the button */
            color: white;
            border: none;
            border-radius: 30px;  /* Adds curved corners to the button */
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s ease;
        }
        button[type="submit"]:hover {
            background-color: #45a049;
        }
        form {
            background-color: #fff;
            padding: 20px;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            margin: 20px;
        }
        
        input[type="number"], input[type="date"], select {
            width: 100%;
            padding: 8px;
            margin: 10px 0;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
        }
        .back-button {
            background-color: #4CAF50;
            color: white;
            padding: 10px 15px;
            margin: 10px 0;
            border: none;
            border-radius: 4px;
            text-decoration: none;
        }
        .back-button:hover {
            background-color: #45a049;
        }
        .flashes {
        list-style-type: none;
        padding: 0;
        margin: 10px;
        }
        .flashes li {
            padding: 10px;
            border-radius: 4px;
            margin-bottom: 5px;
        }
        .flashes .error {
            background-color: #f8d7da;
            color: #721c24;
        }
        .flashes .success {
            background-color: #d4edda;
            color: #155724;
        }
        h1 {
            text-align: left;
            color: #333;
            margin-bottom: 20px;
            font-size: 2.5rem;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);
            position: relative;
            display: inline-block; /* Ensures the underline matches the width of the text */
        }
                
        h1::after {
            content: '';
            position: absolute;
            left: 0;
            bottom: -10px; /* Adjust the position of the underline */
            width: 100%; /* This width will match the width of the h1 text */
            height: 4px; /* Thickness of the underline */
            background: linear-gradient(to right, #3498db, #9b59b6); /* Stylish gradient underline */
            border-radius: 2px;
        }

        h2 {
            text-align: left;
            color: #333;
            margin-bottom: 20px;
            font-size: 2rem; /* Adjust size as needed */
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);
            position: relative;
            display: inline-block; /* Ensures the underline matches the width of the text */
        }
        
        h2::after {
            content: '';
            position: absolute;
            left: 0;
            bottom: -5px; /* Adjust the position of the underline */
            width: 100%; /* This width will match the width of the h2 text */
            height: 3px; /* Thickness of the underline */
            background: linear-gradient(to right, #3498db, #9b59b6); /* Stylish gradient underline */
            border-radius: 2px;
        }
        
        
        
        /* Checkbox container styling */
        .checkbox-container {
            background-color: #fff;
            padding: 20px;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            margin: auto;
            display: flex;
            align-items: center;
            gap: 20px;
            flex-wrap: wrap;
        }
        
        .checkbox-container label {
            margin-right: 10px;
        }
        
        .checkbox-container input[type="date"],
        .checkbox-container select,
        .checkbox-container button {
            margin: 10px 0;
        }
        
        .checkbox-container input[type="date"],
        .checkbox-container select {
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
            width: calc(50% - 22px); /* Adjust width to fit side by side */
        }
        
        .checkbox-container button {
            width: 140px;
            padding: 12px;
            background-color: #3498db; /* Blue color for the button */
            color: white;
            border: none;
            border-radius: 30px; /* Adds curved corners to the button */
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s ease;
        }
        
        .checkbox-container button:hover {
            background-color: #45a049; /* Green on hover */
        }
        
        .checkbox-container .form-group {
            margin-bottom: 15px;
        }
        
        .checkbox-container .form-group label {
            display: inline-block;
            margin-right: 15px;
        }
        
        .checkbox-container .form-group input[type="checkbox"] {
            margin-right: 5px;
        }
        
        .checkbox-container .form-group {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            font-size: 1.1em;
            font-family: 'Arial', sans-serif;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            font-size: 12px;
        }
        
        thead {
            background-color: #009879;
            color: #ffffff;
        }
        
        thead th {
            padding: 12px;
            text-align: left;
        }
        
        tbody tr {
            border-bottom: 1px solid #dddddd;
        }
        
        tbody tr:nth-of-type(even) {
            background-color: #f3f3f3;
        }
        
        tbody tr:nth-of-type(odd) {
            background-color: #ffffff;
        }
        
        tbody tr:hover {
            background-color: #f1f1f1;
            cursor: pointer;
        }
        
        td {
            padding: 12px;
            text-align: left;
        }
        
        tbody td {
            font-size: 1.05em;
        }
        .dataTables_wrapper .dataTables_paginate .paginate_button {
            padding: 6px 12px;
            margin-left: 4px;
            background-color: #009879;
            color: #ffffff !important;
            border-radius: 4px;
            border: 1px solid transparent;
        }
        
        .dataTables_wrapper .dataTables_paginate .paginate_button:hover {
            background-color: #007f5c;
        }
        
        .dataTables_wrapper .dataTables_filter input {
            border: 1px solid #dddddd;
            width:25%;
            padding: 8px;
            border-radius: 4px;
        }
        
        .dataTables_wrapper .dataTables_length select {
            border: 1px solid #dddddd;
            padding: 6px;
            border-radius: 4px;
        }
        .spinner {
            border: 4px solid rgba(0,0,0,0.1);
            border-radius: 50%;
            border-top: 4px solid #3498db;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        
        /* Spinner animation */
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        
        #tradingview-widget-container {
            position: relative;
            width: 100%;
            height: 500px;
        }
        
        div {
            width: 100%;
            height: 100%;
        }
        .charts-container {
            display: flex;
            gap: 20px; /* Adjust the gap between charts as needed */
            margin-top: 20px; /* Add space above the charts */
        }

        .chart-container {
            width: 100%;
            height: 500px;
            background-color: #d3d3d3;
        }
        
        /* Individual chart styling */
        .chart {
            flex: 1;
            min-width: 0; /* Allows charts to shrink as needed */
            height: 400px; /* Adjust height as needed */
            border: 1px solid #ddd; /* Optional: add a border around the charts */
            box-shadow: none;
        }

        .tab {
            overflow: hidden;
            border: 1px solid #ccc;
            background-color: #f1f1f1;
        }
        
        /* Tab links */
        .tablinks {
            background-color: inherit;
            border: none;
            outline: none;
            cursor: pointer;
            padding: 14px 16px;
            transition: 0.3s;
            font-size: 17px;
        }
        
        /* Change background color of buttons on hover */
        .tablinks:hover {
            background-color: #ddd;
        }
        
        /* Create an active/current tablink class */
        .tablinks.active {
            background-color: #ccc;
        }
        
        /* Style the tab content */
        .tabcontent {
            display: none;
            padding: 6px 12px;
            border: 1px solid #ccc;
            border-top: none;
        }
        lotly-chart {
            position: relative;
            width: 100%; 
            height: auto;
            z-index: 1; /* Ensure the chart is not overlapped by other elements */
        }
        
        .plotly-chart .modebar {
            background-color: transparent !important; /* Ensure transparent background */
        }

        .js-plotly-plot .plotly:hover .modebar .modebar-group {
            background-color: rgba(255, 255, 255, 0) !important;
        }
        
    </style>
</head>


<body>
    <form method="POST">
        <div class="form-container" style="width: 100%; box-sizing: border-box; padding: 20px;">
            <h1 style="text-align: center;">Stock Price Prediction</h1>

            <!-- Stock Price Widget -->
            <div id="tradingview-widget-container" style="margin-bottom: 20px;">
                <div id="tradingview-widget"></div>
            </div>

            <!-- Assumption Data Section -->
            <div class="form-container" style="margin-bottom: 30px;">
                <h2>Add Assumption Data</h2>

                <div class="form-row" style="display: flex; flex-wrap: wrap; gap: 20px; align-items: center;">

                    <!-- Select Stock -->
                    <div class="form-group" style="flex: 1;">
                        <label for="ticker_symbol" class="form-label">Select Stock:</label>
                        <select id="ticker_symbol" name="ticker_symbol" class="form-control"  >
                            <option value="" disabled selected>Select a ticker</option>
                            <option value="MSFT" {% if ticker_symbol == "MSFT" %} selected {% endif %}>MSFT: MICROSOFT CORP.</option>
                            <option value="AAPL" {% if ticker_symbol == "AAPL" %} selected {% endif %}>AAPL: APPLE INC</option>
                            <option value="WMT" {% if ticker_symbol == "WMT" %} selected {% endif %}>WMT: WALMART INC.</option>
                            <option value="TSLA" {% if ticker_symbol == "TSLA" %} selected {% endif %}>TSLA: TESLA, INC.</option>
                            <option value="NFLX" {% if ticker_symbol == "NFLX" %} selected {% endif %}>NFLX: NETFLIX, INC.</option>
                        </select>
                    </div>

                    <!-- Date -->
                    <div class="form-group" style="flex: 1;">
                        <label for="ohlc_date" class="form-label">Date:</label>
                        <input type="date" id="ohlc_date" name="ohlc_date" class="form-control"  >
                    </div>

                    <!-- Open -->
                    <div class="form-group" style="flex: 1;">
                        <label for="open" class="form-label">Open:</label>
                        <input type="number" step="0.01" id="open" name="open" class="form-control"  >
                    </div>

                    <!-- High -->
                    <div class="form-group" style="flex: 1;">
                        <label for="high" class="form-label">High:</label>
                        <input type="number" step="0.01" id="high" name="high" class="form-control"  >
                    </div>

                    <!-- Low -->
                    <div class="form-group" style="flex: 1;">
                        <label for="low" class="form-label">Low:</label>
                        <input type="number" step="0.01" id="low" name="low" class="form-control"  >
                    </div>

                    <!-- Close -->
                    <div class="form-group" style="flex: 1;">
                        <label for="close" class="form-label">Close:</label>
                        <input type="number" step="0.01" id="close" name="close" class="form-control"  >
                    </div>

                    <!-- Submit Button -->
                    <div class="form-group" style="flex: 0 1 auto; text-align: right; margin-top: 15px;">
                        <button type="submit" name="assumption" class="btn btn-primary">Submit Data</button>
                    </div>

                </div>
            </div>

            <!-- OHLC Data Section -->
            <div class="container" style="margin-bottom: 30px;">
                {% if ohlc_records %}
                <h3>OHLC Data for {{ ticker_symbol }}</h3>
                <table class="table" id="myTable">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Open</th>
                            <th>High</th>
                            <th>Low</th>
                            <th>Close</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for record in ohlc_records %}
                        <tr>
                            <td>{{ record.date }}</td>
                            <td>{{ record.open }}</td>
                            <td>{{ record.high }}</td>
                            <td>{{ record.low }}</td>
                            <td>{{ record.close }}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
                {% else %}
                <p>No OHLC data available for the selected stock and date range.</p>
                {% endif %}
            </div>

            <!-- Flash Messages Section -->
            {% with messages = get_flashed_messages(with_categories=true) %}
                {% if messages %}
                    <ul class="flashes">
                        {% for category, message in messages %}
                        <li class="{{ category }}">{{ message }}</li>
                        {% endfor %}
                    </ul>
                {% endif %}
            {% endwith %}

            <!-- Performance Evaluation Section -->
            <div class="container">
                <h2>Performance Evaluation</h2>
                <div style="display: flex; gap: 20px; flex-wrap: wrap;">

                    <!-- Select Date -->
                    <div class="form-group" style="flex: 1;">
                        <label for="start_date">Select Date:</label>
                        <input type="date" id="date" name="date" value="{{comparison_date}}" class="form-control">
                    </div>

                    <!-- Select Stock -->
                    <div class="form-group" style="flex: 1;">
                        <label for="ticker_symbol" class="form-label">Select Stock:</label>
                        <select id="ticker_symbol" name="ticker_symbol" class="form-control"  >
                            <option value="" disabled selected>Select a ticker</option>
                            <option value="MSFT" {% if ticker_symbol == "MSFT" %} selected {% endif %}>MSFT: MICROSOFT CORP.</option>
                            <option value="AAPL" {% if ticker_symbol == "AAPL" %} selected {% endif %}>AAPL: APPLE INC</option>
                            <option value="WMT" {% if ticker_symbol == "WMT" %} selected {% endif %}>WMT: WALMART INC.</option>
                            <option value="TSLA" {% if ticker_symbol == "TSLA" %} selected {% endif %}>TSLA: TESLA, INC.</option>
                            <option value="NFLX" {% if ticker_symbol == "NFLX" %} selected {% endif %}>NFLX: NETFLIX, INC.</option>
                        </select>
                    </div>

                    <!-- Submit Button -->
                    <div class="form-group" style="flex: 0 1 auto; margin-top: 10px;">
                        <button type="submit" name="comparison" class="btn btn-primary">Submit</button>
                    </div>
                </div>

                <!-- Chart Options -->
                <div class="form-group" style="margin-top: 20px;">
                    <label><input type="checkbox" id="showHistorical" checked> Historical Data</label>
                    <label><input type="checkbox" id="showPrediction" checked> Prediction Values</label>
                    <label><input type="checkbox" id="showAssumptions" checked> Assumptions</label>
                </div>

                <!-- Tabs for Chart Display -->
                <div class="tab">
                    <button class="tablinks" type="button" onclick="openTab(event, 'chart2Tab')">Chart 2</button>
                    <button class="tablinks" type="button" onclick="openTab(event, 'otherChartsTab')">Individual Charts</button>
                    <button class="tablinks" type="button" onclick="openTab(event, 'newAllThreeTab')">All Single Candlesticks</button>
                </div>

                <!-- Chart Tab Content -->
                <div id="chart2Tab" class="tabcontent plotly-chart">
                    <div id="chart2"></div>
                </div>

                <div id="otherChartsTab" class="tabcontent plotly-chart">
                    <div class="charts-container" style="display: flex; gap: 20px;">
                        <div id="actualChart" class="chart" style="flex: 1;"></div>
                        <div id="predictionChart" class="chart" style="flex: 1;"></div>
                    </div>
                </div>

                <div id="newAllThreeTab" class="tabcontent plotly-chart">
                    <div class="charts-container">
                        <div id="singlecharts" class="chart"></div>
                    </div>
                </div>
            </div>

            <input hidden id="last_submit" value="{{last_submit}}">
        </div>
    </form>
</body>



<script src="https://s3.tradingview.com/tv.js"></script>

<script>
    new TradingView.widget({
        "container_id": "tradingview-widget",
        "autosize": true,
        "symbol": "NASDAQ:AAPL", // Change this to the symbol you want to display
        "interval": "D", // Daily interval
        "theme": "light",
        "style": "1", // 1 for Candlestick, 2 for Bar
        "locale": "en",
        "toolbar_bg": "#f1f3f6",
        "hide_side_toolbar": false,
        "allow_symbol_change": true,
        "show_popup_button": true,
        "popup_width": "1000",
        "popup_height": "650"
    });    
</script>

<script>
    $(document).ready(function () {
        $('#myTable').DataTable({
            paging: true,
            searching: true,
            ordering: true,
            columnDefs: [{
                targets: '_all', 
                orderable: true
            }]
        });
    });
</script>

<script>
    // Static historical data
    const historicalData = [
    {% for Date, Open, High, Low, Close in historical %}
        {Date: '{{Date}}', Open: {{Open}}, High: {{High}}, Low: {{Low}}, Close: {{Close}}},
    {% endfor %}
        
    ];

    // Static actual values
    const assumptions = [
    {% for Date, Open, High, Low, Close in assumptions %}
    {Date: '{{Date}}', Open: {{Open}}, High: {{High}}, Low: {{Low}}, Close: {{Close}}},
    {% endfor %}
    ];

    // Static prediction values
    const predictionValues = [
    {% for Date, Open, High, Low, Close in predictions %}
    {Date: '{{Date}}', Open: {{Open}}, High: {{High}}, Low: {{Low}}, Close: {{Close}}},
    {% endfor %}
    ];


    const historicalrecords = [
    {% for Date, Open, High, Low, Close in historical_records %}
    {Date: '{{Date}}', Open: {{Open}}, High: {{High}}, Low: {{Low}}, Close: {{Close}}},
    {% endfor %}
    ];


    const singlerecords = [
    {% for Date, Open, High, Low, Close in dfsingles %}
    {Date: '{{Date}}', Open: {{Open}}, High: {{High}}, Low: {{Low}}, Close: {{Close}}},
    {% endfor %}
    ];


    // Convert historical data to Plotly format
    const historicalTrace = {
        x: historicalData.map(data => data.Date),
        close: historicalData.map(data => data.Close),
        high: historicalData.map(data => data.High),
        low: historicalData.map(data => data.Low),
        open: historicalData.map(data => data.Open),
        name: 'Actual Data',
        type: 'candlestick',
        increasing: { line: { color: 'green' } },
        decreasing: { line: { color: 'red' } }
    };

    

    // Convert prediction values to Plotly format
    const predictionTrace = {
        x: predictionValues.map(data => data.Date),
        close: predictionValues.map(data => data.Close),
        high: predictionValues.map(data => data.High),
        low: predictionValues.map(data => data.Low),
        open: predictionValues.map(data => data.Open),
        name: 'Prediction Values',
        type: 'candlestick',
        increasing: { line: { color: 'purple' } },
        decreasing: { line: { color: 'orange' } }
    };

    // Convert assumptions values to Plotly format
    const assumptionsTrace = {
        x: assumptions.map(data => data.Date),
        close: assumptions.map(data => data.Close),
        high: assumptions.map(data => data.High),
        low: assumptions.map(data => data.Low),
        open: assumptions.map(data => data.Open),
        name: 'Assumptions',
        type: 'candlestick',
        increasing: { line: { color: 'black' } },
        decreasing: { line: { color: 'gray' } }
    };

    // Convert assumptions values to Plotly format
    const historical_recordsTrace = {
        x: historicalrecords.map(data => data.Date),
        close: historicalrecords.map(data => data.Close),
        high: historicalrecords.map(data => data.High),
        low: historicalrecords.map(data => data.Low),
        open: historicalrecords.map(data => data.Open),
        name: 'Actual',
        type: 'candlestick',
        increasing: { line: { color: 'green' } },
        decreasing: { line: { color: 'red' } },
        
    };

    // Convert prediction values to Plotly format
    const singlerecordsTrace = {
        x: singlerecords.map((_, index) => index + 1),
        close: singlerecords.map(data => data.Close),
        high: singlerecords.map(data => data.High),
        low: singlerecords.map(data => data.Low),
        open: singlerecords.map(data => data.Open),
        name: 'single candlesticks',
        type: 'candlestick',
        increasing: { line: { color: 'red' } },
        decreasing: { line: { color: 'orange' } }
    };

    // Combine traces into a single data array
    const traces = {
        historical: historicalTrace,
        prediction: predictionTrace,
        assumptions: assumptionsTrace
    };
   



    const HistoricalTracerecords = {
        historical_records: historical_recordsTrace,
    
    };
    const PredictionTracerecords = {
    
        prediction: predictionTrace,
    
    };

    const singleTracerecords = {
    
       singlerecords :singlerecordsTrace ,
    
    };

    // Define layout
    layout = {
        title: 'Candlestick Chart',
        xaxis: {
            title: 'Date',
            rangeslider: { visible: true }  // Hide range slider
        },
        yaxis: {
        
            title: 'Price',
            autorange: true,  // Auto-scaling Y-axis based on data
            fixedrange: false,  // Allow Y-axis zooming
            // Scale the axis from zero upwards
            
        },
        legend: {
            x: 0.1,
            y: 1.1,
            orientation: 'v'
        }
    };
    layout1 = {
        title: 'Candlestick Chart1',
        xaxis: {
            title: 'Date',
            rangeslider: { visible: true }  // Hide range slider
        },
        yaxis: {
        
            title: 'Price',
            autorange: true,  // Auto-scaling Y-axis based on data
            fixedrange: false,  // Allow Y-axis zooming
            // Scale the axis from zero upwards
            
        },
        legend: {
            x: 0.1,
            y: 1.1,
            orientation: 'v'
        }
    };
    layout2 = {
        title: 'Candlestick Chart2',
        xaxis: {
            title: 'Date',
            rangeslider: { visible: true }  // Hide range slider
        },
        yaxis: {
        
            title: 'Price',
            autorange: true,  // Auto-scaling Y-axis based on data
            fixedrange: false,  // Allow Y-axis zooming
            // Scale the axis from zero upwards
            
        },
        legend: {
            x: 0.1,
            y: 1.1,
            orientation: 'v'
        }
    };
    layout3 = {
        title: 'Candlestick Chart',
        xaxis: {
        title: 'Candlestick Number', // Change the x-axis title
        tickmode: 'linear', // Show numerical ticks for frequency
        tickvals: [1, 2, 3],
        
        },
        yaxis: {
        
            title: 'Price',
            autorange: true,  // Auto-scaling Y-axis based on data
            fixedrange: false,  // Allow Y-axis zooming
            // Scale the axis from zero upwards
            
        },
        legend: {
            x: 0.1,
            y: 1.1,
            orientation: 'v'
        }
    };
    
    function renderChart2() {
        Plotly.react('chart2', [historicalTrace,predictionTrace,assumptionsTrace], layout);
    }

    // Function to render Other Charts
    function renderOtherCharts() {
        Plotly.react('actualChart', [historical_recordsTrace], layout1);
        Plotly.react('predictionChart', [predictionTrace], layout2);
    }

    // Function to render Single Candlestick Charts
    function renderSingleCharts() {
        Plotly.react('singlecharts', [singlerecordsTrace], layout3);
    }

    // Function to open a specific tab
    function openTab(event, tabId) {
        event.preventDefault();  // Prevent default behavior

        // Hide all tab contents
        const tabContents = document.getElementsByClassName('tabcontent');
        for (let i = 0; i < tabContents.length; i++) {
            tabContents[i].style.display = 'none';
        }

        // Remove 'active' class from all tab buttons
        const tabButtons = document.getElementsByClassName('tablinks');
        for (let i = 0; i < tabButtons.length; i++) {
            tabButtons[i].className = tabButtons[i].className.replace(' active', '');
        }

        // Show the selected tab
        document.getElementById(tabId).style.display = 'block';
        event.currentTarget.className += ' active';

        // Render charts based on the tab
        if (tabId === 'chart2Tab') {
            renderChart2();  // Render Chart 2
        } else if (tabId === 'otherChartsTab') {
            renderOtherCharts();  // Render other charts
        } else if (tabId === 'newAllThreeTab') {
            renderSingleCharts();  // Render singlecandlestick charts
        }
    }

    // Function to submit the form
    function submitForm(event) {
        event.preventDefault();  // Prevent page reload

        // Grab selected date and stock ticker
        const selectedDate = document.getElementById("date").value;
        const tickerSymbol = document.getElementById("ticker_symbol").value;

        // Fetch data and render Chart 2 (replace this with actual logic to fetch your data)
        if (selectedDate && tickerSymbol) {
            renderChart2();  // Call renderChart2 with fetched data
        }
    }

    

    // Function to update chart visibility based on checkboxes
    function updateChart() {
        const visibleTraces = [];
        if (document.getElementById('showHistorical').checked) visibleTraces.push(traces.historical);
        if (document.getElementById('showPrediction').checked) visibleTraces.push(traces.prediction);
        if (document.getElementById('showAssumptions').checked) visibleTraces.push(traces.assumptions);
        
        Plotly.react('chart2', visibleTraces, layout);
    }
    // Attach event listeners to checkboxes
    document.getElementById('showHistorical').addEventListener('change', updateChart);
    document.getElementById('showPrediction').addEventListener('change', updateChart);
    document.getElementById('showAssumptions').addEventListener('change', updateChart);
</script> 

<script>
    document.addEventListener('DOMContentLoaded', function () {
        // Get the value of the hidden input
        var lastSubmit = document.getElementById('last_submit').value;
        
        // Check if the value is 'comparison'
        if (lastSubmit === 'comparison') {
            // Scroll to the bottom of the page
            window.scrollTo(0, document.body.scrollHeight);
        }

        // Add click event listener to button
        var submitButton = document.getElementById('submitButton');
        if (submitButton) {
            submitButton.addEventListener('click', function() {
                // Additional logic here if needed
                console.log('Button clicked');
            });
        } else {
            console.error('Button not found');
        }
    });
</script>

</html>